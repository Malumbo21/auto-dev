<!-- Plugin Configuration File for mpp-idea Compose UI module -->
<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude">
    <id>cc.unitmesh.devins.idea</id>
    <name>Xiuper</name>
    <vendor email="h@phodal.com" url="https://github.com/phodal">Phodal</vendor>

    <description><![CDATA[
    AutoDev Idea - Provides Compose-based UI components for IntelliJ IDEA 2025.2+.
    This module leverages Jewel theme for native IDE integration with DevIn language support.
    ]]></description>

    <!-- Required for Compose support in IDEA 252+ -->
    <dependencies>
        <module name="intellij.platform.compose"/>
        <plugin id="org.jetbrains.plugins.terminal"/>
        <!-- DevIn language support for @ and / completion -->
        <plugin id="org.intellij.plugins.markdown"/>
        <plugin id="com.jetbrains.sh"/>
        <plugin id="Git4Idea"/>
    </dependencies>

    <resource-bundle>messages.AutoDevIdeaBundle</resource-bundle>

    <!-- Extension points required by devins-lang module (normally defined in autodev-core.xml) -->
    <extensionPoints>
        <extensionPoint qualifiedName="cc.unitmesh.languageProcessor"
                        interface="cc.unitmesh.devti.provider.devins.LanguageProcessor"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.runService"
                        interface="cc.unitmesh.devti.provider.RunService"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.sketchToolchainProvider"
                        interface="cc.unitmesh.devti.sketch.SketchToolchainProvider"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.devInsAgentTool"
                        interface="cc.unitmesh.devti.provider.DevInsAgentToolCollector"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.shirePostProcessor"
                        interface="cc.unitmesh.devti.devins.post.PostProcessor"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.shireLocationInteraction"
                        interface="cc.unitmesh.devti.devins.provider.LocationInteractionProvider"
                        dynamic="true"/>

        <extensionPoint qualifiedName="cc.unitmesh.customDevInsCompletionProvider"
                        interface="cc.unitmesh.devti.provider.devins.DevInsSymbolProvider"
                        dynamic="true"/>
    </extensionPoints>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Project-level service for coroutine scope management -->
        <projectService serviceImplementation="cc.unitmesh.devins.idea.services.CoroutineScopeHolder"/>
        <!-- Project-level service for tool configuration state management -->
        <projectService serviceImplementation="cc.unitmesh.devins.idea.services.IdeaToolConfigService"/>
        <!-- Project-level service for Omnibar data provider -->
        <projectService serviceImplementation="cc.unitmesh.devins.idea.omnibar.IdeaOmnibarDataProvider"/>
        <!-- ToolWindow for Agent UI with tab-based navigation (Advanced version) -->
        <toolWindow factoryClass="cc.unitmesh.devins.idea.toolwindow.IdeaAgentToolWindowFactory"
                    id="AutoDev Agent"
                    anchor="right"
                    secondary="false"
                    icon="cc.unitmesh.devins.idea.AutoDevIcons.ToolWindow"/>
    </extensions>

    <actions>
        <!-- Omnibar Command Palette -->
        <action id="cc.unitmesh.devins.idea.omnibar.IdeaOmnibarAction"
                class="cc.unitmesh.devins.idea.omnibar.IdeaOmnibarAction"
                text="Open Omnibar"
                description="Open the Omnibar command palette">
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl shift P"/>
            <keyboard-shortcut keymap="Mac OS X" first-keystroke="meta shift P"/>
            <keyboard-shortcut keymap="Mac OS X 10.5+" first-keystroke="meta shift P"/>
            <add-to-group group-id="ToolsMenu" anchor="first"/>
        </action>
    </actions>

    <!-- Include DevIn language extensions -->
    <xi:include href="/cc.unitmesh.devti.language.xml" xpointer="xpointer(/idea-plugin/*)"/>
</idea-plugin>

